<!DOCTYPE html>
<html lang="bn" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rakib Raihan - Premium Digital Products</title>
    
    <!-- Firebase Configuration -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-analytics.js";
        import { 
            getAuth, 
            createUserWithEmailAndPassword, 
            updateProfile,
            GoogleAuthProvider,
            signInWithPopup,
            onAuthStateChanged,
            signInWithEmailAndPassword,
            setPersistence,
            browserLocalPersistence,
            sendPasswordResetEmail,
            sendEmailVerification
        } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";
        import { getDatabase, ref, set, get, onValue, push } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyCndBh3s0Binb5k6eJNk9WEGo7FbGzwxdY",
            authDomain: "rakib-raihan.firebaseapp.com",
            projectId: "rakib-raihan",
            storageBucket: "rakib-raihan.firebasestorage.app",
            messagingSenderId: "348348178384",
            appId: "1:348348178384:web:7af06dfcad47bbd27723d5",
            measurementId: "G-R5DP5KC0GW"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const database = getDatabase(app);
        
        // Enable persistence
        setPersistence(auth, browserLocalPersistence)
            .then(() => {
                console.log('✅ Auth persistence enabled');
            })
            .catch((error) => {
                console.error('❌ Error enabling auth persistence:', error);
            });
        
        // Configure Google Auth Provider
        const googleProvider = new GoogleAuthProvider();
        googleProvider.setCustomParameters({
            prompt: 'select_account',
            // Add additional scopes if needed
            scope: 'profile email'
        });

        // Make auth and database available globally
        window.auth = auth;
        window.database = database;
        window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.updateProfile = updateProfile;
        window.googleProvider = googleProvider;
        window.signInWithPopup = signInWithPopup;
        window.ref = ref;
        window.set = set;
        window.get = get;
        window.onValue = onValue;
        window.push = push;

        // Check initial auth state
        auth.onAuthStateChanged((user) => {
            console.log('🔍 Initial auth state check:', user ? 'User is signed in' : 'No user signed in');
        });

        // Verify database connection
        const verifyDatabaseConnection = async () => {
            try {
                const testRef = ref(database, 'test');
                await set(testRef, {
                    timestamp: new Date().toISOString(),
                    message: 'Test connection'
                });
                console.log('✅ Database connection verified');
                return true;
            } catch (error) {
                console.error('❌ Database connection failed:', error);
                return false;
            }
        };

        // Initialize database and verify connection
        verifyDatabaseConnection().then(isConnected => {
            if (!isConnected) {
                console.error('Database connection failed. Please check your Firebase configuration.');
            }
        });

        // User behavior tracking functions
        const trackUserBehavior = async (userId, action, details = {}) => {
            if (!userId) {
                console.log('❌ No user ID available for tracking');
                return;
            }

            if (!database) {
                console.error('❌ Database not initialized');
                return;
            }

            console.log('📝 Tracking behavior:', { userId, action, details });

            try {
                const behaviorRef = ref(database, `userBehavior/${userId}`);
                const newBehaviorRef = push(behaviorRef);
                
                await set(newBehaviorRef, {
                    action,
                    timestamp: new Date().toISOString(),
                    details,
                    userAgent: navigator.userAgent,
                    screenSize: `${window.innerWidth}x${window.innerHeight}`,
                    ...details
                });
                console.log('✅ Successfully tracked behavior:', action);
            } catch (error) {
                console.error('❌ Error tracking behavior:', error);
            }
        };

        // Track page views
        const trackPageView = (userId) => {
            trackUserBehavior(userId, 'page_view', {
                page: window.location.pathname,
                referrer: document.referrer
            });
        };

        // Track product views
        const trackProductView = (userId, productId, productName) => {
            console.log('📦 Product clicked:', { userId, productId, productName });
            trackUserBehavior(userId, 'product_view', {
                productId,
                productName
            });
        };

        // Track button clicks
        const trackButtonClick = (userId, buttonId, buttonText) => {
            console.log('🔘 Button clicked:', { userId, buttonId, buttonText });
            trackUserBehavior(userId, 'button_click', {
                buttonId,
                buttonText
            });
        };

        // Track form submissions
        const trackFormSubmission = (userId, formId, formData) => {
            trackUserBehavior(userId, 'form_submission', {
                formId,
                formData
            });
        };

        // Track time spent
        let sessionStartTime = new Date();
        const trackTimeSpent = (userId) => {
            const timeSpent = new Date() - sessionStartTime;
            trackUserBehavior(userId, 'time_spent', {
                duration: timeSpent,
                page: window.location.pathname
            });
        };

        // Listen for auth state changes
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                console.log('👤 User is signed in:', user);
                
                try {
                    // Create/Update user data in database
                    const userRef = ref(database, 'users/' + user.uid);
                    await set(userRef, {
                        email: user.email,
                        displayName: user.displayName,
                        lastLogin: new Date().toISOString(),
                        photoURL: user.photoURL,
                        lastUpdated: new Date().toISOString()
                    });
                    console.log('✅ User data saved successfully');

                    // Track initial page view
                    await trackUserBehavior(user.uid, 'page_view', {
                        page: window.location.pathname,
                        referrer: document.referrer
                    });
                    
                    // Hide login/signup buttons
                    document.querySelectorAll('.login-btn, .signup-btn').forEach(btn => {
                        btn.style.display = 'none';
                    });
                    // Show sign out button
                    document.getElementById('signOutBtn').classList.remove('hidden');
                    document.getElementById('mobileSignOutBtn').classList.remove('hidden');
                    // Show admin button
                    document.getElementById('adminBtn').classList.remove('hidden');
                } catch (error) {
                    console.error('❌ Error saving user data:', error);
                }
            } else {
                console.log('👤 User is signed out');
                // Show login/signup buttons
                document.querySelectorAll('.login-btn, .signup-btn').forEach(btn => {
                    btn.style.display = 'block';
                });
                // Hide sign out button
                document.getElementById('signOutBtn').classList.add('hidden');
                document.getElementById('mobileSignOutBtn').classList.add('hidden');
                // Hide admin button
                document.getElementById('adminBtn').classList.add('hidden');
            }
        });

        // Add event listeners for tracking
        document.addEventListener('click', async (e) => {
            const user = auth.currentUser;
            if (!user) {
                console.log('❌ No user logged in for tracking');
                return;
            }

            console.log('🖱️ Click event detected:', e.target);

            try {
                // Track button clicks
                if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
                    const button = e.target.tagName === 'BUTTON' ? e.target : e.target.closest('button');
                    console.log('🔘 Button clicked:', button);
                    await trackUserBehavior(user.uid, 'button_click', {
                        buttonId: button.id || 'unnamed-button',
                        buttonText: button.textContent.trim()
                    });
                }

                // Track product clicks
                if (e.target.closest('.product-card')) {
                    const productCard = e.target.closest('.product-card');
                    const productId = productCard.dataset.title;
                    const productName = productCard.querySelector('h3').textContent;
                    console.log('📦 Product clicked:', { productId, productName });
                    await trackUserBehavior(user.uid, 'product_view', {
                        productId,
                        productName
                    });
                }
            } catch (error) {
                console.error('❌ Error tracking click event:', error);
            }
        });

        // Track time spent every 5 minutes
        setInterval(() => {
            const user = auth.currentUser;
            if (user) {
                trackTimeSpent(user.uid);
            }
        }, 5 * 60 * 1000);

        // Track page views
        window.addEventListener('load', () => {
            const user = auth.currentUser;
            if (user) {
                trackPageView(user.uid);
            }
        });
    </script>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    
    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- কাস্টম স্টাইল -->
    <style>
        body {
            font-family: 'Hind Siliguri', sans-serif;
            background-color: #0B1120; /* Deep dark blue background */
            color: #E0E0E0;
        }
        .font-heading {
            font-family: 'Poppins', sans-serif;
        }
        .glass-card {
            background: rgba(23, 33, 56, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            transform: translateY(-8px);
            border-color: rgba(56, 189, 248, 0.5);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        .gradient-text {
            background: linear-gradient(90deg, #38bdf8, #a78bfa);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .btn-primary {
            background: linear-gradient(90deg, #0ea5e9, #6366f1);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
        }
        .floating-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 40;
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .hero-pattern {
            background-image: radial-gradient(circle at 1px 1px, rgba(255, 255, 255, 0.1) 1px, transparent 0);
            background-size: 40px 40px;
        }
        .testimonial-card {
            transition: all 0.3s ease;
        }
        .testimonial-card:hover {
            transform: translateY(-5px);
        }
        .newsletter-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        .newsletter-input:focus {
            border-color: #38bdf8;
            box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.2);
        }
        
        /* Enhanced Header Button Styles */
        .nav-link {
            position: relative;
            padding: 0.75rem 1.25rem;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #38bdf8, #a78bfa);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .signup-btn {
            background: linear-gradient(90deg, #0ea5e9, #6366f1);
            position: relative;
            overflow: hidden;
            z-index: 1;
            font-size: 1rem;
            padding: 0.75rem 1.75rem;
            min-width: 140px;
            text-align: center;
        }
        
        .signup-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #0ea5e9);
            transition: all 0.4s ease;
            z-index: -1;
        }
        
        .signup-btn:hover::before {
            left: 0;
        }
        
        .login-btn {
            position: relative;
            overflow: hidden;
            font-size: 1rem;
            padding: 0.75rem 1.75rem;
            min-width: 120px;
            text-align: center;
        }
        
        .login-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-100%);
            transition: all 0.3s ease;
        }
        
        .login-btn:hover::before {
            transform: translateX(0);
        }
        
        .profile-img {
            display: none;
        }
        
        .profile-img:hover {
            display: none;
        }

        /* Mobile Menu Button Styles */
        .mobile-menu-btn {
            padding: 0.75rem 1.25rem;
            font-size: 1rem;
            width: 100%;
            text-align: center;
        }

        /* Sign Up Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            position: relative;
            background: #1a2234;
            width: 90%;
            max-width: 500px;
            margin: 50px auto;
            padding: 2rem;
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            color: white;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #38bdf8;
            box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.2);
        }
        
        /* Enhanced Error Message Styles */
        .error-message {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            padding: 0.75rem;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .error-message i {
            color: #ef4444;
        }
        
        .success-message {
            color: #10b981;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            padding: 0.75rem;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .success-message i {
            color: #10b981;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .google-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        /* Enhanced Responsive Styles */
        @media (max-width: 768px) {
            .container {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            .hero-section h1 {
                font-size: 2.5rem;
                line-height: 1.2;
            }
            
            .hero-section p {
                font-size: 1rem;
            }
            
            .product-card {
                margin-bottom: 1.5rem;
            }
            
            .testimonial-card {
                margin-bottom: 1.5rem;
            }
        }
        
        /* Modal Responsive Styles */
        @media (max-width: 640px) {
            .modal-content {
                width: 95%;
                margin: 1rem auto;
                padding: 1.5rem;
            }
            
            .form-input {
                padding: 0.625rem 0.875rem;
            }
            
            .google-btn {
                padding: 0.625rem 0.875rem;
            }
            
            .divider {
                margin: 1rem 0;
            }
        }
        
        /* Header Responsive Styles */
        @media (max-width: 1024px) {
            .nav-link {
                padding: 0.5rem 0.75rem;
            }
            
            .signup-btn, .login-btn {
                padding: 0.625rem 1.25rem;
                font-size: 0.875rem;
            }
        }
        
        /* Product Grid Responsive */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        /* Testimonial Grid Responsive */
        .testimonial-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        /* Newsletter Section Responsive */
        @media (max-width: 640px) {
            .newsletter-form {
                flex-direction: column;
            }
            
            .newsletter-input {
                margin-bottom: 1rem;
            }
        }
        
        /* Footer Responsive */
        @media (max-width: 768px) {
            .footer-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
                text-align: center;
            }
            
            .social-links {
                justify-content: center;
            }
        }
    </style>
</head>
<body class="antialiased">

    <!-- ===== হেডার ===== -->
    <header class="bg-slate-900/80 backdrop-blur-sm sticky top-0 z-50 border-b border-slate-800">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-24">
                <a href="#" id="home-link" class="text-3xl font-bold font-heading gradient-text hover:opacity-90 transition">Rakib Raihan</a>
                
                <nav class="hidden lg:flex items-center space-x-8">
                    <a href="#home" class="nav-link text-base font-medium text-slate-300 hover:text-white">Home</a>
                    <a href="#products" class="nav-link text-base font-medium text-slate-300 hover:text-white">Products</a>
                    <a href="#testimonials" class="nav-link text-base font-medium text-slate-300 hover:text-white">Testimonials</a>
                </nav>

                <div class="flex items-center space-x-6">
                    <div class="hidden lg:flex items-center space-x-6">
                        <a href="#" class="login-btn text-base font-medium text-slate-300 hover:text-white rounded-lg">Login</a>
                        <a href="#" class="signup-btn text-white text-base font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-300">Sign Up</a>
                        <button id="signOutBtn" class="hidden signout-btn text-base font-medium text-red-400 hover:text-red-300 rounded-lg border border-red-400/50 px-4 py-2 hover:bg-red-400/10 transition-all duration-300">
                            Sign Out
                        </button>
                    </div>
                    <div class="lg:hidden">
                        <button id="menu-btn" class="text-gray-300 hover:text-white transition-colors">
                            <i data-feather="menu" class="w-8 h-8"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- মোবাইল মেনু -->
        <div id="mobile-menu" class="hidden lg:hidden bg-slate-900 absolute w-full shadow-lg">
            <a href="#home" class="block py-4 px-6 text-base hover:bg-slate-800 transition-colors">Home</a>
            <a href="#products" class="block py-4 px-6 text-base hover:bg-slate-800 transition-colors">Products</a>
            <a href="#testimonials" class="block py-4 px-6 text-base hover:bg-slate-800 transition-colors">Testimonials</a>
            <div class="border-t border-slate-800 p-6 space-y-4">
                <a href="#" class="mobile-menu-btn block text-center text-base font-medium bg-slate-700 py-3 rounded-lg hover:bg-slate-600 transition-colors">Login</a>
                <a href="#" class="mobile-menu-btn block text-center signup-btn text-white text-base font-semibold py-3 rounded-lg">Sign Up</a>
                <button id="mobileSignOutBtn" class="hidden w-full text-center text-base font-medium text-red-400 hover:text-red-300 py-3 rounded-lg border border-red-400/50 hover:bg-red-400/10 transition-all duration-300">
                    Sign Out
                </button>
            </div>
        </div>
    </header>

    <main>
        <!-- ===== হোম পেজ কন্টেন্ট ===== -->
        <div id="homePage">
            <!-- হিরো সেকশন -->
            <section id="home" class="relative py-16 md:py-24 lg:py-32 text-center overflow-hidden hero-pattern">
                <div class="absolute inset-0 bg-gradient-to-b from-slate-900/50 to-slate-900"></div>
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative">
                    <div data-aos="fade-up" data-aos-duration="1000">
                        <h1 class="font-heading text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold text-white leading-tight">
                        Ideas to Reality with <span class="gradient-text">Digital Tools</span>
                    </h1>
                        <p class="mt-4 sm:mt-6 max-w-2xl mx-auto text-base sm:text-lg text-slate-400">
                            আপনার প্রজেক্টের জন্য প্রয়োজনীয় প্রিমিয়াম ডিজিটাল প্রোডাক্টস, যা আপনার কাজকে করবে আরও সহজ ও আকর্ষণীয়।
                        </p>
                        <div class="mt-8 sm:mt-10 flex flex-col sm:flex-row gap-4 justify-center">
                            <a href="#products" class="btn-primary text-white font-semibold py-3 px-6 sm:px-8 rounded-lg shadow-lg text-sm sm:text-base">প্রোডাক্টগুলো দেখুন</a>
                            <a href="#contact" class="bg-slate-700/50 text-white font-semibold py-3 px-6 sm:px-8 rounded-lg hover:bg-slate-700 transition text-sm sm:text-base">যোগাযোগ করুন</a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- প্রোডাক্টস সেকশন -->
            <section id="products" class="py-16 sm:py-20">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="text-center mb-12 sm:mb-16">
                        <h2 class="font-heading text-2xl sm:text-3xl md:text-4xl font-bold text-white">Featured Products</h2>
                        <p class="mt-4 text-slate-400">আমাদের精心ভাবে তৈরি করা সেরা কিছু প্রোডাক্ট।</p>
                    </div>
                    <div class="product-grid">
                        <!-- প্রোডাক্ট কার্ড (এখানে data-* attribute ব্যবহার করে প্রোডাক্টের তথ্য দেওয়া হয়েছে) -->
                        <a href="#" class="product-card glass-card rounded-xl p-6 block" 
                            data-title="প্রোফেশনাল UI কিট" 
                            data-price="৪৯৫০" 
                            data-image="https://placehold.co/800x600/6366f1/ffffff?text=UI+Kit" 
                            data-description="যেকোনো ওয়েব অ্যাপলিকেশনের জন্য একটি সম্পূর্ণ, আধুনিক এবং রেসপন্সিভ UI কিট। এতে ১০০+ কম্পোনেন্ট এবং পৃষ্ঠা রয়েছে।"
                            data-rating="4.8"
                            data-reviews="120">
                            <img src="https://placehold.co/600x400/6366f1/ffffff?text=UI+Kit" alt="UI Kit" class="w-full h-48 object-cover rounded-lg mb-6">
                            <h3 class="font-heading text-xl font-bold text-white mb-2">প্রোফেশনাল UI কিট</h3>
                            <p class="text-slate-400 mb-4 text-sm">অ্যাপলিকেশন তৈরির জন্য সেরা ডিজাইন সিস্টেম।</p>
                            <div class="flex justify-between items-center mt-4">
                                <span class="text-2xl font-bold font-heading text-sky-400">৳৪৯৫০</span>
                                <span class="text-sm font-medium bg-slate-700/50 px-3 py-1 rounded-full">বিস্তারিত দেখুন &rarr;</span>
                            </div>
                        </a>
                        <!-- প্রোডাক্ট কার্ড ২ -->
                        <a href="#" class="product-card glass-card rounded-xl p-6 block"
                            data-title="সোশ্যাল মিডিয়া টেমপ্লেট" 
                            data-price="১৯৯০" 
                            data-image="https://placehold.co/800x600/ec4899/ffffff?text=Templates" 
                            data-description="ইনস্টাগ্রাম, ফেসবুক ও টুইটারের জন্য ডিজাইন করা ২০০+ আকর্ষণীয় এবং সহজেই সম্পাদনাযোগ্য টেমপ্লেট। আপনার ব্র্যান্ডকে ফুটিয়ে তুলুন।"
                            data-rating="4.9"
                            data-reviews="250">
                            <img src="https://placehold.co/600x400/ec4899/ffffff?text=Templates" alt="Social Media Templates" class="w-full h-48 object-cover rounded-lg mb-6">
                            <h3 class="font-heading text-xl font-bold text-white mb-2">সোশ্যাল মিডিয়া টেমপ্লেট</h3>
                            <p class="text-slate-400 mb-4 text-sm">আপনার সোশ্যাল মিডিয়া পোস্টকে দিন নতুন রূপ।</p>
                            <div class="flex justify-between items-center mt-4">
                                <span class="text-2xl font-bold font-heading text-sky-400">৳১৯৯০</span>
                                <span class="text-sm font-medium bg-slate-700/50 px-3 py-1 rounded-full">বিস্তারিত দেখুন &rarr;</span>
                            </div>
                        </a>
                        <!-- প্রোডাক্ট কার্ড ৩ -->
                        <a href="#" class="product-card glass-card rounded-xl p-6 block"
                            data-title="3D আইকন প্যাক" 
                            data-price="২৯০০" 
                            data-image="https://placehold.co/800x600/f59e0b/ffffff?text=3D+Icons" 
                            data-description="আপনার ওয়েবসাইট ও অ্যাপকে আরও আকর্ষণীয় করতে ৫০০+ হাই-কোয়ালিটি 3D আইকন। বিভিন্ন ফরম্যাটে উপলব্ধ।"
                            data-rating="5.0"
                            data-reviews="95">
                            <img src="https://placehold.co/600x400/f59e0b/ffffff?text=3D+Icons" alt="3D Icons" class="w-full h-48 object-cover rounded-lg mb-6">
                            <h3 class="font-heading text-xl font-bold text-white mb-2">3D আইকন প্যাক</h3>
                            <p class="text-slate-400 mb-4 text-sm">আপনার ডিজাইনে নতুন মাত্রা যোগ করুন।</p>
                            <div class="flex justify-between items-center mt-4">
                                <span class="text-2xl font-bold font-heading text-sky-400">৳২৯০০</span>
                                <span class="text-sm font-medium bg-slate-700/50 px-3 py-1 rounded-full">বিস্তারিত দেখুন &rarr;</span>
                            </div>
                        </a>
                    </div>
                </div>
            </section>
            
             <!-- Testimonials Section -->
            <section id="testimonials" class="py-16 sm:py-20">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="text-center mb-12 sm:mb-16">
                        <h2 class="font-heading text-2xl sm:text-3xl md:text-4xl font-bold text-white">What Our Clients Say</h2>
                    </div>
                    <div class="testimonial-grid">
                        <div class="glass-card p-8 rounded-xl">
                            <p class="text-slate-300 italic">"Rakib Raihan-এর ডিজিটাল প্রোডাক্টগুলো আমার কাজের গতি অনেক বাড়িয়ে দিয়েছে। UI কিটটি অসাধারণ ছিল!"</p>
                            <div class="flex items-center mt-6">
                                <img class="w-12 h-12 rounded-full" src="https://i.pravatar.cc/150?u=client1" alt="Client 1">
                                <div class="ml-4">
                                    <p class="font-bold text-white">আরিফ হোসেন</p>
                                    <p class="text-sm text-slate-400">ফ্রিল্যান্স ডেভেলপার</p>
                                </div>
                            </div>
                        </div>
                         <div class="glass-card p-8 rounded-xl">
                            <p class="text-slate-300 italic">"সোশ্যাল মিডিয়া টেমপ্লেটগুলো ব্যবহার করে আমার ক্লায়েন্টদের জন্য দারুণ সব পোস্ট তৈরি করতে পারছি। Highly recommended!"</p>
                            <div class="flex items-center mt-6">
                                <img class="w-12 h-12 rounded-full" src="https://i.pravatar.cc/150?u=client2" alt="Client 2">
                                <div class="ml-4">
                                    <p class="font-bold text-white">ফারজানা চৌধুরী</p>
                                    <p class="text-sm text-slate-400">ডিজিটাল মার্কেটার</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ===== প্রোডাক্ট পেজ কন্টেন্ট (Hidden by default) ===== -->
        <div id="productPage" class="hidden">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-16">
                <div class="mb-8">
                    <button id="back-to-home" class="flex items-center text-slate-300 hover:text-white transition">
                        <i data-feather="arrow-left" class="mr-2"></i>
                        সব প্রোডাক্ট দেখুন
                    </button>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                    <!-- প্রোডাক্ট ইমেজ -->
                    <div>
                        <img id="product-image" src="" alt="Product Image" class="w-full h-auto object-cover rounded-xl shadow-2xl cursor-pointer">
                        <button id="view-full-image" class="mt-4 w-full text-center py-2 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition">সম্পূর্ণ ছবি দেখুন</button>
                    </div>
                    <!-- প্রোডাক্টের বিবরণ -->
                    <div class="flex flex-col justify-center">
                        <h1 id="product-title" class="font-heading text-4xl font-bold text-white"></h1>
                        <div class="flex items-center my-4">
                            <div id="product-rating-stars" class="flex text-amber-400"></div>
                            <span id="product-rating" class="ml-2 text-slate-400"></span>
                            <span class="text-slate-500 mx-2">|</span>
                            <span id="product-reviews" class="text-slate-400"></span>
                        </div>
                        <p id="product-description" class="text-slate-300 leading-relaxed mb-6"></p>
                        
                        <div class="my-6">
                            <span class="text-4xl font-bold font-heading gradient-text" id="product-price"></span>
                        </div>
                        
                        <div class="flex flex-col sm:flex-row gap-4">
                            <button class="btn-primary text-white font-semibold py-3 px-8 rounded-lg flex-grow">
                                <i data-feather="shopping-cart" class="inline-block -mt-1 mr-2"></i>
                                Buy Now
                            </button>
                            <button class="bg-slate-700/50 text-white font-semibold py-3 px-8 rounded-lg hover:bg-slate-700 transition flex-grow">
                                <i data-feather="heart" class="inline-block -mt-1 mr-2"></i>
                                Add to Wishlist
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Newsletter Section -->
        <section class="py-16 sm:py-20 bg-slate-900/50">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="max-w-2xl mx-auto text-center" data-aos="fade-up">
                    <h2 class="font-heading text-2xl sm:text-3xl font-bold text-white mb-4">Stay Updated</h2>
                    <p class="text-slate-400 mb-8">নতুন প্রোডাক্ট এবং অফার সম্পর্কে জানতে আমাদের নিউজলেটারে সাবস্ক্রাইব করুন।</p>
                    <form class="newsletter-form flex flex-col sm:flex-row gap-4">
                        <input type="email" placeholder="আপনার ইমেইল" class="newsletter-input flex-grow px-4 py-3 rounded-lg text-white focus:outline-none">
                        <button type="submit" class="btn-primary text-white font-semibold py-3 px-6 sm:px-8 rounded-lg text-sm sm:text-base">সাবস্ক্রাইব</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- User Panel Section (Hidden by default) -->
        <div id="userPanel" class="hidden min-h-screen bg-slate-900 py-12">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="max-w-4xl mx-auto">
                    <!-- User Profile Header -->
                    <div class="glass-card rounded-xl p-6 mb-8">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <img id="userProfileImage" src="" alt="Profile" class="w-16 h-16 rounded-full border-2 border-sky-400">
                                <div>
                                    <h2 id="userDisplayName" class="text-2xl font-bold text-white"></h2>
                                    <p id="userEmail" class="text-slate-400"></p>
                                </div>
                            </div>
                            <button id="editProfileBtn" class="btn-primary text-white font-semibold py-2 px-4 rounded-lg">
                                <i data-feather="edit-2" class="w-4 h-4 inline-block mr-2"></i>
                                Edit Profile
                            </button>
                        </div>
                    </div>

                    <!-- User Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="glass-card rounded-xl p-6">
                            <h3 class="text-lg font-semibold text-white mb-2">Total Visits</h3>
                            <p id="totalVisits" class="text-3xl font-bold text-sky-400">0</p>
                        </div>
                        <div class="glass-card rounded-xl p-6">
                            <h3 class="text-lg font-semibold text-white mb-2">Products Viewed</h3>
                            <p id="productsViewed" class="text-3xl font-bold text-sky-400">0</p>
                        </div>
                        <div class="glass-card rounded-xl p-6">
                            <h3 class="text-lg font-semibold text-white mb-2">Last Login</h3>
                            <p id="lastLogin" class="text-3xl font-bold text-sky-400">-</p>
                        </div>
                    </div>

                    <!-- Activity History -->
                    <div class="glass-card rounded-xl p-6 mb-8">
                        <h3 class="text-xl font-bold text-white mb-4">Recent Activity</h3>
                        <div id="activityList" class="space-y-4">
                            <!-- Activity items will be added here dynamically -->
                        </div>
                    </div>

                    <!-- Account Settings -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-xl font-bold text-white mb-4">Account Settings</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                                <div>
                                    <h4 class="text-white font-semibold">Email Notifications</h4>
                                    <p class="text-slate-400 text-sm">Receive updates about new products</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="emailNotifications" class="sr-only peer">
                                    <div class="w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-sky-500"></div>
                                </label>
                            </div>
                            <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                                <div>
                                    <h4 class="text-white font-semibold">Two-Factor Authentication</h4>
                                    <p class="text-slate-400 text-sm">Add an extra layer of security</p>
                                </div>
                                <button class="btn-primary text-white font-semibold py-2 px-4 rounded-lg">
                                    Enable
                                </button>
                            </div>
                            <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                                <div>
                                    <h4 class="text-white font-semibold">Delete Account</h4>
                                    <p class="text-slate-400 text-sm">Permanently delete your account and data</p>
                                </div>
                                <button id="deleteAccountBtn" class="text-red-400 hover:text-red-300 font-semibold py-2 px-4 rounded-lg border border-red-400/50 hover:bg-red-400/10 transition-all duration-300">
                                    Delete
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- ===== ফুটার ===== -->
    <footer class="bg-slate-900/80 border-t border-slate-800 mt-16 sm:mt-20">
        <div class="container mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="footer-grid grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold font-heading gradient-text mb-4">Rakib Raihan</h3>
                    <p class="text-slate-400">প্রিমিয়াম ডিজিটাল প্রোডাক্টস এবং সেবা প্রদানকারী।</p>
                </div>
                <div>
                    <h4 class="text-white font-semibold mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="#home" class="text-slate-400 hover:text-sky-400 transition">হোম</a></li>
                        <li><a href="#products" class="text-slate-400 hover:text-sky-400 transition">প্রোডাক্টস</a></li>
                        <li><a href="#testimonials" class="text-slate-400 hover:text-sky-400 transition">প্রশংসা</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-white font-semibold mb-4">Contact</h4>
                    <ul class="space-y-2">
                        <li class="text-slate-400">
                            <a href="mailto:rakibraihan316@gmail.com" class="hover:text-sky-400 transition-colors flex items-center">
                                <i data-feather="mail" class="w-4 h-4 mr-2"></i>
                                rakibraihan316@gmail.com
                            </a>
                        </li>
                        <li class="text-slate-400">
                            <a href="tel:+8801788163380" class="hover:text-sky-400 transition-colors flex items-center">
                                <i data-feather="phone" class="w-4 h-4 mr-2"></i>
                                +880 1788-163380
                            </a>
                        </li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-white font-semibold mb-4">Follow Us</h4>
                    <div class="flex space-x-4">
                        <a href="https://www.facebook.com/share/199HqyFPuq/" target="_blank" class="text-slate-400 hover:text-sky-400 transition-colors">
                            <i data-feather="facebook" class="w-6 h-6"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="border-t border-slate-800 mt-8 pt-8 text-center text-slate-400">
                <p>&copy; 2025 Rakib Raihan. All Rights Reserved.</p>
                <a href="/admin" id="adminBtn" class="hidden mt-4 inline-block text-xs text-slate-500 hover:text-slate-300 transition-colors">
                    <i data-feather="settings" class="w-3 h-3 inline-block mr-1"></i>
                    Admin Panel
                </a>
            </div>
        </div>
    </footer>
    
    <!-- ===== ইমেজ মডাল (বড় করে ছবি দেখার জন্য) ===== -->
    <div id="imageModal" class="hidden fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4">
        <div class="relative">
            <button id="closeModal" class="absolute -top-4 -right-4 text-white bg-slate-800 rounded-full p-2">
                <i data-feather="x" class="w-6 h-6"></i>
            </button>
            <img id="modalImage" src="" class="max-w-full max-h-[90vh] rounded-lg">
        </div>
    </div>

    <!-- Floating Action Button -->
    <a href="#" class="floating-btn bg-sky-600 text-white p-4 rounded-full shadow-lg hover:bg-sky-500 transition">
        <i data-feather="arrow-up" class="w-6 h-6"></i>
    </a>

    <!-- Sign Up Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content">
            <button id="closeSignupModal" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                <i data-feather="x" class="w-6 h-6"></i>
            </button>
            <h2 class="text-2xl font-bold text-white mb-6">Create Account</h2>
            
            <!-- Google Sign In Button -->
            <button id="googleSignIn" class="google-btn mb-6">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                <span id="googleBtnText">Continue with Google</span>
                <span id="googleBtnSpinner" class="loading-spinner hidden"></span>
            </button>
            
            <div class="divider">
                <span>or</span>
            </div>
            
            <form id="signupForm" class="space-y-4">
                <div>
                    <input type="text" id="displayName" class="form-input" placeholder="Full Name" required>
                </div>
                <div>
                    <input type="email" id="email" class="form-input" placeholder="Email Address" required>
                </div>
                <div>
                    <input type="password" id="password" class="form-input" placeholder="Password" required minlength="6">
                </div>
                <div>
                    <input type="password" id="confirmPassword" class="form-input" placeholder="Confirm Password" required minlength="6">
                </div>
                <div id="errorMessage" class="error-message hidden">
                    <i data-feather="alert-circle" class="w-5 h-5"></i>
                    <span id="errorText"></span>
                </div>
                <div id="successMessage" class="success-message hidden">
                    <i data-feather="check-circle" class="w-5 h-5"></i>
                    <span id="successText"></span>
                </div>
                <button type="submit" class="w-full btn-primary text-white font-semibold py-3 px-8 rounded-lg">
                    Create Account
                </button>
            </form>
            <p class="mt-4 text-center text-slate-400">
                Already have an account? 
                <a href="#" class="text-sky-400 hover:text-sky-300" id="showLoginLink">Login</a>
            </p>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button id="closeLoginModal" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                <i data-feather="x" class="w-6 h-6"></i>
            </button>
            <h2 class="text-2xl font-bold text-white mb-6">Login to Your Account</h2>
            
            <!-- Google Sign In Button -->
            <button id="googleLoginBtn" class="google-btn mb-6">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                <span id="googleLoginBtnText">Continue with Google</span>
                <span id="googleLoginBtnSpinner" class="loading-spinner hidden"></span>
            </button>
            
            <div class="divider">
                <span>or</span>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <input type="email" id="loginEmail" class="form-input" placeholder="Email Address" required>
                </div>
                <div>
                    <input type="password" id="loginPassword" class="form-input" placeholder="Password" required>
                </div>
                <div id="loginErrorMessage" class="error-message hidden">
                    <i data-feather="alert-circle" class="w-5 h-5"></i>
                    <span id="loginErrorText"></span>
                </div>
                <div id="loginSuccessMessage" class="success-message hidden">
                    <i data-feather="check-circle" class="w-5 h-5"></i>
                    <span id="loginSuccessText"></span>
                </div>
                <button type="submit" class="w-full btn-primary text-white font-semibold py-3 px-8 rounded-lg">
                    Login
                </button>
            </form>
            <p class="mt-4 text-center text-slate-400">
                Don't have an account? 
                <a href="#" class="text-sky-400 hover:text-sky-300" id="showSignupLink">Sign Up</a>
            </p>
        </div>
    </div>

    <!-- ===== JavaScript Section ===== -->
    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            once: true
        });

        // আইকন রেন্ডার করার জন্য
        feather.replace();

        // ===== পেজ ন্যাভিগেশন এবং ডাইনামিক কন্টেন্ট =====
        const homePage = document.getElementById('homePage');
        const productPage = document.getElementById('productPage');
        const productCards = document.querySelectorAll('.product-card');
        const backToHomeBtn = document.getElementById('back-to-home');
        const homeLink = document.getElementById('home-link');

        // প্রোডাক্ট কার্ডে ক্লিক করলে প্রোডাক্ট পেজ দেখাবে
        productCards.forEach(card => {
            card.addEventListener('click', (e) => {
                e.preventDefault();
                
                // কার্ড থেকে ডেটা নেওয়া
                const title = card.dataset.title;
                const price = card.dataset.price;
                const image = card.dataset.image;
                const description = card.dataset.description;
                const rating = parseFloat(card.dataset.rating);
                const reviews = card.dataset.reviews;

                // প্রোডাক্ট পেজের কন্টেন্ট আপডেট করা
                document.getElementById('product-title').innerText = title;
                document.getElementById('product-price').innerText = `৳${price}`;
                document.getElementById('product-image').src = image;
                document.getElementById('product-description').innerText = description;
                document.getElementById('product-rating').innerText = `${rating} stars`;
                document.getElementById('product-reviews').innerText = `${reviews} reviews`;
                
                // রেটিং স্টার তৈরি করা
                const ratingStarsContainer = document.getElementById('product-rating-stars');
                ratingStarsContainer.innerHTML = '';
                for(let i=1; i<=5; i++){
                    const star = document.createElement('i');
                    star.dataset.feather = i <= rating ? 'star' : 'star';
                    star.classList.add('w-5', 'h-5');
                    if(i <= rating) {
                        star.classList.add('fill-current');
                    }
                    ratingStarsContainer.appendChild(star);
                }
                feather.replace(); // নতুন আইকন রেন্ডার করার জন্য

                // পেজ পরিবর্তন
                homePage.classList.add('hidden');
                productPage.classList.remove('hidden');
                window.scrollTo(0, 0); // পৃষ্ঠার উপরে স্ক্রল করুন
            });
        });

        // হোম পেজে ফিরে যাওয়ার জন্য
        function showHomePage() {
            homePage.classList.remove('hidden');
            productPage.classList.add('hidden');
        }
        
        backToHomeBtn.addEventListener('click', showHomePage);
        homeLink.addEventListener('click', (e) => {
            e.preventDefault();
            showHomePage();
        });

        // ===== মোবাইল মেনু টগল =====
        const menuBtn = document.getElementById('menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        menuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // ===== ইমেজ মডাল =====
        const imageModal = document.getElementById('imageModal');
        const viewFullImageBtn = document.getElementById('view-full-image');
        const closeModalBtn = document.getElementById('closeModal');
        const modalImage = document.getElementById('modalImage');
        const mainProductImage = document.getElementById('product-image');

        function openModal() {
            modalImage.src = mainProductImage.src;
            imageModal.classList.remove('hidden');
            imageModal.classList.add('flex');
        }

        function closeModal() {
            imageModal.classList.add('hidden');
            imageModal.classList.remove('flex');
        }

        viewFullImageBtn.addEventListener('click', openModal);
        mainProductImage.addEventListener('click', openModal);
        closeModalBtn.addEventListener('click', closeModal);
        
        // মডালের বাইরে ক্লিক করলে বন্ধ হবে
        imageModal.addEventListener('click', (e) => {
            if(e.target === imageModal) {
                closeModal();
            }
        });

        // Smooth scroll for floating button
        document.querySelector('.floating-btn').addEventListener('click', (e) => {
            e.preventDefault();
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Newsletter form submission
        document.querySelector('form').addEventListener('submit', (e) => {
            e.preventDefault();
            const email = e.target.querySelector('input[type="email"]').value;
            // Add your newsletter subscription logic here
            alert('Thank you for subscribing!');
            e.target.reset();
        });

        // Sign Up Modal Functionality
        const signupModal = document.getElementById('signupModal');
        const signupForm = document.getElementById('signupForm');
        const closeSignupModal = document.getElementById('closeSignupModal');
        const signupLinks = document.querySelectorAll('.signup-btn');
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');

        // Login Modal Functionality
        const loginModal = document.getElementById('loginModal');
        const loginForm = document.getElementById('loginForm');
        const closeLoginModal = document.getElementById('closeLoginModal');
        const loginLinks = document.querySelectorAll('.login-btn');
        const loginErrorMessage = document.getElementById('loginErrorMessage');
        const loginSuccessMessage = document.getElementById('loginSuccessMessage');
        const showSignupLink = document.getElementById('showSignupLink');
        const showLoginLink = document.getElementById('showLoginLink');

        // Show signup modal when clicking sign up buttons
        signupLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                console.log('🔘 Sign up button clicked');
                signupModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
                
                // Reset form and messages
                signupForm.reset();
                errorMessage.classList.add('hidden');
                successMessage.classList.add('hidden');
            });
        });

        // Show login modal when clicking login buttons
        loginLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                console.log('🔘 Login button clicked');
                loginModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
                
                // Reset form and messages
                loginForm.reset();
                loginErrorMessage.classList.add('hidden');
                loginSuccessMessage.classList.add('hidden');
            });
        });

        // Close signup modal
        closeSignupModal.addEventListener('click', () => {
            signupModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        });

        // Close login modal
        closeLoginModal.addEventListener('click', () => {
            loginModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        });

        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === signupModal) {
                signupModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
            if (e.target === loginModal) {
                loginModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });

        // Switch between login and signup modals
        showSignupLink.addEventListener('click', (e) => {
            e.preventDefault();
            loginModal.style.display = 'none';
            signupModal.style.display = 'block';
        });

        showLoginLink.addEventListener('click', (e) => {
            e.preventDefault();
            signupModal.style.display = 'none';
            loginModal.style.display = 'block';
        });

        // Handle login form submission
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            console.log('📝 Login form submitted');
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            // Reset messages
            loginErrorMessage.classList.add('hidden');
            loginSuccessMessage.classList.add('hidden');

            try {
                console.log('🔄 Attempting login...');
                // Sign in user
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                console.log('✅ Login successful:', user);

                // Show success message
                loginSuccessMessage.textContent = 'Successfully logged in!';
                loginSuccessMessage.classList.remove('hidden');

                // Clear form
                loginForm.reset();

                // Close modal after 2 seconds
                setTimeout(() => {
                    loginModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }, 2000);

            } catch (error) {
                console.error('❌ Login error:', error);
                // Handle errors
                let errorMsg = 'An error occurred during login';
                if (error.code === 'auth/user-not-found') {
                    errorMsg = 'No account found with this email';
                } else if (error.code === 'auth/wrong-password') {
                    errorMsg = 'Incorrect password';
                } else if (error.code === 'auth/invalid-email') {
                    errorMsg = 'Invalid email address';
                } else if (error.code === 'auth/user-disabled') {
                    errorMsg = 'This account has been disabled';
                }
                
                loginErrorMessage.textContent = errorMsg;
                loginErrorMessage.classList.remove('hidden');
            }
        });

        // Handle signup form submission
        signupForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            console.log('📝 Sign up form submitted');
            
            const displayName = document.getElementById('displayName').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // Reset messages
            errorMessage.classList.add('hidden');
            successMessage.classList.add('hidden');

            // Validate passwords match
            if (password !== confirmPassword) {
                errorMessage.textContent = 'Passwords do not match';
                errorMessage.classList.remove('hidden');
                return;
            }

            try {
                console.log('🔄 Creating user account...');
                // Create user
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                console.log('✅ User created, updating profile...');
                // Update profile
                await updateProfile(user, {
                    displayName: displayName
                });

                // Show success message
                successMessage.textContent = 'Account created successfully!';
                successMessage.classList.remove('hidden');

                // Clear form
                signupForm.reset();

                // Close modal after 2 seconds
                setTimeout(() => {
                    signupModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }, 2000);

            } catch (error) {
                console.error('❌ Error during sign up:', error);
                // Handle errors
                let errorMsg = 'An error occurred during sign up';
                if (error.code === 'auth/email-already-in-use') {
                    errorMsg = 'This email is already registered';
                } else if (error.code === 'auth/weak-password') {
                    errorMsg = 'Password should be at least 6 characters';
                } else if (error.code === 'auth/invalid-email') {
                    errorMsg = 'Invalid email address';
                }
                
                errorMessage.textContent = errorMsg;
                errorMessage.classList.remove('hidden');
            }
        });

        // Google Sign In for both modals
        const handleGoogleSignIn = async (isLogin = false) => {
            const modal = isLogin ? loginModal : signupModal;
            const errorElement = isLogin ? loginErrorMessage : errorMessage;
            const successElement = isLogin ? loginSuccessMessage : successMessage;
            
            try {
                // Show loading state
                const googleBtn = isLogin ? document.getElementById('googleLoginBtn') : document.getElementById('googleSignIn');
                const googleBtnText = isLogin ? document.getElementById('googleLoginBtnText') : document.getElementById('googleBtnText');
                const googleBtnSpinner = isLogin ? document.getElementById('googleLoginBtnSpinner') : document.getElementById('googleBtnSpinner');

                googleBtn.disabled = true;
                googleBtnText.textContent = 'Signing in...';
                googleBtnSpinner.classList.remove('hidden');
                errorElement.classList.add('hidden');
                successElement.classList.add('hidden');

                console.log('🔄 Attempting Google sign in...');
                // Attempt Google sign in
                const result = await signInWithPopup(auth, googleProvider);
                const user = result.user;
                
                console.log('✅ Google sign in successful:', user);
                
                // Show success message
                successElement.textContent = 'Successfully signed in with Google!';
                successElement.classList.remove('hidden');
                
                // Close modal after 2 seconds
                setTimeout(() => {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }, 2000);
                
            } catch (error) {
                console.error('❌ Google sign in error:', error);
                
                // Enhanced error handling
                let errorMsg = 'An error occurred during Google sign in';
                if (error.code === 'auth/popup-closed-by-user') {
                    errorMsg = 'Sign in was cancelled. Please try again.';
                } else if (error.code === 'auth/popup-blocked') {
                    errorMsg = 'Pop-up was blocked by your browser. Please allow pop-ups for this site.';
                } else if (error.code === 'auth/cancelled-popup-request') {
                    errorMsg = 'Sign in was cancelled. Please try again.';
                } else if (error.code === 'auth/network-request-failed') {
                    errorMsg = 'Network error. Please check your internet connection and try again.';
                } else if (error.code === 'auth/account-exists-with-different-credential') {
                    errorMsg = 'An account already exists with the same email address but different sign-in credentials.';
                } else if (error.code === 'auth/operation-not-allowed') {
                    errorMsg = 'Google sign in is not enabled. Please contact support.';
                } else if (error.code === 'auth/unauthorized-domain') {
                    errorMsg = 'This domain is not authorized. Please add this domain to Firebase Console: ' + window.location.hostname;
                }
                
                errorElement.textContent = errorMsg;
                errorElement.classList.remove('hidden');
                
            } finally {
                // Reset button state
                const googleBtn = isLogin ? document.getElementById('googleLoginBtn') : document.getElementById('googleSignIn');
                const googleBtnText = isLogin ? document.getElementById('googleLoginBtnText') : document.getElementById('googleBtnText');
                const googleBtnSpinner = isLogin ? document.getElementById('googleLoginBtnSpinner') : document.getElementById('googleBtnSpinner');
                
                googleBtn.disabled = false;
                googleBtnText.textContent = 'Continue with Google';
                googleBtnSpinner.classList.add('hidden');
            }
        };

        // Update Google Sign In button click handlers
        document.getElementById('googleSignIn').addEventListener('click', () => handleGoogleSignIn(false));
        document.getElementById('googleLoginBtn').addEventListener('click', () => handleGoogleSignIn(true));

        // Add sign out functionality
        const signOutBtn = document.getElementById('signOutBtn');
        const mobileSignOutBtn = document.getElementById('mobileSignOutBtn');

        async function handleSignOut() {
            try {
                await auth.signOut();
                console.log('✅ User signed out successfully');
                
                // Show success message
                const successMessage = document.createElement('div');
                successMessage.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                successMessage.textContent = 'Successfully signed out!';
                document.body.appendChild(successMessage);
                
                // Remove success message after 3 seconds
                setTimeout(() => {
                    successMessage.remove();
                }, 3000);
                
            } catch (error) {
                console.error('❌ Error signing out:', error);
                
                // Show error message
                const errorMessage = document.createElement('div');
                errorMessage.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                errorMessage.textContent = 'Error signing out. Please try again.';
                document.body.appendChild(errorMessage);
                
                // Remove error message after 3 seconds
                setTimeout(() => {
                    errorMessage.remove();
                }, 3000);
            }
        }

        // Add click event listeners for sign out buttons
        document.getElementById('signOutBtn').addEventListener('click', handleSignOut);
        document.getElementById('mobileSignOutBtn').addEventListener('click', handleSignOut);

        // User Panel Functions
        const userPanel = document.getElementById('userPanel');
        const userProfileImage = document.getElementById('userProfileImage');
        const userDisplayName = document.getElementById('userDisplayName');
        const userEmail = document.getElementById('userEmail');
        const totalVisits = document.getElementById('totalVisits');
        const productsViewed = document.getElementById('productsViewed');
        const lastLogin = document.getElementById('lastLogin');
        const activityList = document.getElementById('activityList');
        const editProfileBtn = document.getElementById('editProfileBtn');
        const deleteAccountBtn = document.getElementById('deleteAccountBtn');

        // Update user panel data
        const updateUserPanel = async (user) => {
            if (!user) return;

            // Update profile information
            userProfileImage.src = user.photoURL || 'https://i.pravatar.cc/150?u=' + user.uid;
            userDisplayName.textContent = user.displayName || 'User';
            userEmail.textContent = user.email;

            try {
                // Get user data from database
                const userRef = ref(database, 'users/' + user.uid);
                const userSnapshot = await get(userRef);
                const userData = userSnapshot.val();

                if (userData) {
                    lastLogin.textContent = new Date(userData.lastLogin).toLocaleDateString();
                }

                // Get user behavior data
                const behaviorRef = ref(database, 'userBehavior/' + user.uid);
                const behaviorSnapshot = await get(behaviorRef);
                const behaviorData = behaviorSnapshot.val();

                if (behaviorData) {
                    // Count total visits and product views
                    let visits = 0;
                    let productViews = 0;
                    const activities = [];

                    Object.values(behaviorData).forEach(activity => {
                        if (activity.action === 'page_view') visits++;
                        if (activity.action === 'product_view') productViews++;
                        
                        activities.push({
                            action: activity.action,
                            timestamp: activity.timestamp,
                            details: activity.details
                        });
                    });

                    totalVisits.textContent = visits;
                    productsViewed.textContent = productViews;

                    // Sort activities by timestamp
                    activities.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

                    // Display recent activities
                    activityList.innerHTML = activities.slice(0, 5).map(activity => `
                        <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                            <div>
                                <h4 class="text-white font-semibold">${formatActivity(activity.action)}</h4>
                                <p class="text-slate-400 text-sm">${new Date(activity.timestamp).toLocaleString()}</p>
                            </div>
                            <div class="text-slate-400">
                                ${formatActivityDetails(activity.details)}
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error updating user panel:', error);
            }
        };

        // Format activity type
        const formatActivity = (action) => {
            const formats = {
                'page_view': 'Page View',
                'product_view': 'Product View',
                'button_click': 'Button Click',
                'form_submission': 'Form Submission',
                'time_spent': 'Time Spent'
            };
            return formats[action] || action;
        };

        // Format activity details
        const formatActivityDetails = (details) => {
            if (!details) return '';
            
            if (details.productName) {
                return details.productName;
            }
            if (details.buttonText) {
                return details.buttonText;
            }
            if (details.page) {
                return details.page;
            }
            return '';
        };

        // Update auth state change listener
        let authStateInitialized = false;

        onAuthStateChanged(auth, async (user) => {
            console.log('🔄 Auth state changed:', user ? 'User is signed in' : 'No user signed in');
            
            // Wait for DOM to be ready
            if (!authStateInitialized) {
                await new Promise(resolve => setTimeout(resolve, 100));
                authStateInitialized = true;
            }

            if (user) {
                console.log('👤 User is signed in:', user);
                
                try {
                    // Create/Update user data in database
                    const userRef = ref(database, 'users/' + user.uid);
                    await set(userRef, {
                        email: user.email,
                        displayName: user.displayName,
                        lastLogin: new Date().toISOString(),
                        photoURL: user.photoURL,
                        lastUpdated: new Date().toISOString()
                    });
                    console.log('✅ User data saved successfully');

                    // Update user panel
                    await updateUserPanel(user);
                    
                    // Show user panel
                    userPanel.classList.remove('hidden');
                    
                    // Hide login/signup buttons
                    document.querySelectorAll('.login-btn, .signup-btn').forEach(btn => {
                        btn.style.display = 'none';
                    });
                    
                    // Show sign out button
                    const signOutBtn = document.getElementById('signOutBtn');
                    const mobileSignOutBtn = document.getElementById('mobileSignOutBtn');
                    
                    if (signOutBtn) signOutBtn.classList.remove('hidden');
                    if (mobileSignOutBtn) mobileSignOutBtn.classList.remove('hidden');
                    
                    // Show admin button
                    const adminBtn = document.getElementById('adminBtn');
                    if (adminBtn) adminBtn.classList.remove('hidden');

                    // Update user profile in header if exists
                    const userProfileContainer = document.createElement('div');
                    userProfileContainer.className = 'flex items-center space-x-4';
                    userProfileContainer.innerHTML = `
                        <img src="${user.photoURL || 'https://i.pravatar.cc/150?u=' + user.uid}" 
                             alt="Profile" 
                             class="w-8 h-8 rounded-full border-2 border-sky-400">
                        <span class="text-white">${user.displayName || user.email}</span>
                    `;
                    
                    // Replace login/signup buttons with profile in desktop header
                    const desktopAuthButtons = document.querySelector('.hidden.lg\\:flex.items-center.space-x-6');
                    if (desktopAuthButtons) {
                        desktopAuthButtons.innerHTML = '';
                        desktopAuthButtons.appendChild(userProfileContainer);
                        if (signOutBtn) desktopAuthButtons.appendChild(signOutBtn);
                    }

                    // Update mobile menu
                    const mobileAuthButtons = document.querySelector('#mobile-menu .border-t.border-slate-800.p-6.space-y-4');
                    if (mobileAuthButtons) {
                        mobileAuthButtons.innerHTML = `
                            <div class="flex items-center space-x-4 mb-4">
                                <img src="${user.photoURL || 'https://i.pravatar.cc/150?u=' + user.uid}" 
                                     alt="Profile" 
                                     class="w-8 h-8 rounded-full border-2 border-sky-400">
                                <span class="text-white">${user.displayName || user.email}</span>
                            </div>
                        `;
                        if (mobileSignOutBtn) mobileAuthButtons.appendChild(mobileSignOutBtn);
                    }

                } catch (error) {
                    console.error('❌ Error saving user data:', error);
                }
            } else {
                console.log('👤 User is signed out');
                // Hide user panel
                userPanel.classList.add('hidden');
                
                // Show login/signup buttons
                document.querySelectorAll('.login-btn, .signup-btn').forEach(btn => {
                    btn.style.display = 'block';
                });
                
                // Hide sign out button
                const signOutBtn = document.getElementById('signOutBtn');
                const mobileSignOutBtn = document.getElementById('mobileSignOutBtn');
                
                if (signOutBtn) signOutBtn.classList.add('hidden');
                if (mobileSignOutBtn) mobileSignOutBtn.classList.add('hidden');
                
                // Hide admin button
                const adminBtn = document.getElementById('adminBtn');
                if (adminBtn) adminBtn.classList.add('hidden');

                // Reset desktop header auth buttons
                const desktopAuthButtons = document.querySelector('.hidden.lg\\:flex.items-center.space-x-6');
                if (desktopAuthButtons) {
                    desktopAuthButtons.innerHTML = `
                        <a href="#" class="login-btn text-base font-medium text-slate-300 hover:text-white rounded-lg">Login</a>
                        <a href="#" class="signup-btn text-white text-base font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-300">Sign Up</a>
                    `;
                }

                // Reset mobile menu auth buttons
                const mobileAuthButtons = document.querySelector('#mobile-menu .border-t.border-slate-800.p-6.space-y-4');
                if (mobileAuthButtons) {
                    mobileAuthButtons.innerHTML = `
                        <a href="#" class="mobile-menu-btn block text-center text-base font-medium bg-slate-700 py-3 rounded-lg hover:bg-slate-600 transition-colors">Login</a>
                        <a href="#" class="mobile-menu-btn block text-center signup-btn text-white text-base font-semibold py-3 rounded-lg">Sign Up</a>
                    `;
                }
            }
        });

        // Edit Profile Button Click
        editProfileBtn.addEventListener('click', async () => {
            const newDisplayName = prompt('Enter your new display name:', userDisplayName.textContent);
            if (newDisplayName && newDisplayName.trim()) {
                try {
                    const user = auth.currentUser;
                    await updateProfile(user, {
                        displayName: newDisplayName.trim()
                    });
                    
                    // Update database
                    const userRef = ref(database, 'users/' + user.uid);
                    await set(userRef, {
                        ...userData,
                        displayName: newDisplayName.trim(),
                        lastUpdated: new Date().toISOString()
                    });
                    
                    // Update UI
                    userDisplayName.textContent = newDisplayName.trim();
                    
                    // Show success message
                    const successMessage = document.createElement('div');
                    successMessage.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                    successMessage.textContent = 'Profile updated successfully!';
                    document.body.appendChild(successMessage);
                    
                    setTimeout(() => successMessage.remove(), 3000);
                } catch (error) {
                    console.error('Error updating profile:', error);
                    alert('Failed to update profile. Please try again.');
                }
            }
        });

        // Add delete account functionality
        deleteAccountBtn.addEventListener('click', async () => {
            if (confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
                try {
                    const user = auth.currentUser;
                    
                    // Delete user data from database
                    const userRef = ref(database, 'users/' + user.uid);
                    const behaviorRef = ref(database, 'userBehavior/' + user.uid);
                    await set(userRef, null);
                    await set(behaviorRef, null);
                    
                    // Delete user account
                    await user.delete();
                    
                    // Show success message
                    const successMessage = document.createElement('div');
                    successMessage.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                    successMessage.textContent = 'Account deleted successfully!';
                    document.body.appendChild(successMessage);
                    
                    setTimeout(() => successMessage.remove(), 3000);
                } catch (error) {
                    console.error('Error deleting account:', error);
                    alert('Failed to delete account. Please try again.');
                }
            }
        });

        // Add password reset functionality
        const resetPasswordBtn = document.createElement('button');
        resetPasswordBtn.className = 'text-sky-400 hover:text-sky-300 text-sm';
        resetPasswordBtn.textContent = 'Forgot Password?';
        loginForm.insertBefore(resetPasswordBtn, loginForm.querySelector('button[type="submit"]'));

        resetPasswordBtn.addEventListener('click', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            
            if (!email) {
                alert('Please enter your email address first.');
                return;
            }
            
            try {
                await sendPasswordResetEmail(auth, email);
                alert('Password reset email sent. Please check your inbox.');
            } catch (error) {
                console.error('Error sending password reset email:', error);
                alert('Failed to send password reset email. Please try again.');
            }
        });

        // Add email verification functionality
        const sendVerificationEmail = async () => {
            const user = auth.currentUser;
            if (user && !user.emailVerified) {
                try {
                    await sendEmailVerification(user);
                    alert('Verification email sent. Please check your inbox.');
                } catch (error) {
                    console.error('Error sending verification email:', error);
                    alert('Failed to send verification email. Please try again.');
                }
            }
        };

        // Add verification status check
        onAuthStateChanged(auth, async (user) => {
            if (user && !user.emailVerified) {
                const verifyEmailBtn = document.createElement('button');
                verifyEmailBtn.className = 'text-sky-400 hover:text-sky-300 text-sm';
                verifyEmailBtn.textContent = 'Verify Email';
                verifyEmailBtn.onclick = sendVerificationEmail;
                
                const userPanel = document.getElementById('userPanel');
                if (userPanel) {
                    userPanel.insertBefore(verifyEmailBtn, userPanel.firstChild);
                }
            }
        });

        // Add session timeout handling
        let sessionTimeout;
        const resetSessionTimeout = () => {
            clearTimeout(sessionTimeout);
            sessionTimeout = setTimeout(async () => {
                const user = auth.currentUser;
                if (user) {
                    try {
                        await auth.signOut();
                        alert('Your session has expired. Please log in again.');
                    } catch (error) {
                        console.error('Error during session timeout:', error);
                    }
                }
            }, 30 * 60 * 1000); // 30 minutes
        };

        // Reset timeout on user activity
        ['click', 'keypress', 'scroll', 'mousemove'].forEach(event => {
            document.addEventListener(event, resetSessionTimeout);
        });

        // Initialize session timeout
        resetSessionTimeout();

        // Wishlist and Buy Now functionality
        const addToWishlist = async (productId, productName, price, image) => {
            const user = auth.currentUser;
            if (!user) {
                alert('Please login to add items to your wishlist');
                return;
            }

            try {
                const wishlistRef = ref(database, `wishlists/${user.uid}/${productId}`);
                await set(wishlistRef, {
                    productId,
                    productName,
                    price,
                    image,
                    addedAt: new Date().toISOString()
                });

                // Show success message
                const successMessage = document.createElement('div');
                successMessage.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                successMessage.textContent = 'Added to wishlist!';
                document.body.appendChild(successMessage);
                setTimeout(() => successMessage.remove(), 3000);

                // Track the action
                await trackUserBehavior(user.uid, 'wishlist_add', {
                    productId,
                    productName
                });
            } catch (error) {
                console.error('Error adding to wishlist:', error);
                alert('Failed to add to wishlist. Please try again.');
            }
        };

        const buyNow = async (productId, productName, price, image) => {
            const user = auth.currentUser;
            if (!user) {
                alert('Please login to purchase items');
                return;
            }

            try {
                // Create order
                const orderRef = ref(database, `orders/${user.uid}`);
                const newOrderRef = push(orderRef);
                await set(newOrderRef, {
                    productId,
                    productName,
                    price,
                    image,
                    status: 'pending',
                    createdAt: new Date().toISOString()
                });

                // Show success message
                const successMessage = document.createElement('div');
                successMessage.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                successMessage.textContent = 'Order placed successfully!';
                document.body.appendChild(successMessage);
                setTimeout(() => successMessage.remove(), 3000);

                // Track the action
                await trackUserBehavior(user.uid, 'purchase', {
                    productId,
                    productName,
                    price
                });

                // Redirect to payment page or show payment modal
                showPaymentModal(productName, price);
            } catch (error) {
                console.error('Error processing purchase:', error);
                alert('Failed to process purchase. Please try again.');
            }
        };

        // Payment Modal
        const showPaymentModal = (productName, price) => {
            const paymentModal = document.createElement('div');
            paymentModal.className = 'fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4';
            paymentModal.innerHTML = `
                <div class="bg-slate-900 rounded-lg p-6 max-w-md w-full">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-white">Complete Your Purchase</h3>
                        <button class="text-gray-400 hover:text-white" onclick="this.closest('.fixed').remove()">
                            <i data-feather="x" class="w-6 h-6"></i>
                        </button>
                    </div>
                    <div class="space-y-4">
                        <div class="bg-slate-800/50 p-4 rounded-lg">
                            <p class="text-white">${productName}</p>
                            <p class="text-sky-400 font-bold">৳${price}</p>
                        </div>
                        <form id="paymentForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-1">Card Number</label>
                                <input type="text" class="form-input" placeholder="1234 5678 9012 3456" required>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-400 mb-1">Expiry Date</label>
                                    <input type="text" class="form-input" placeholder="MM/YY" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-400 mb-1">CVV</label>
                                    <input type="text" class="form-input" placeholder="123" required>
                                </div>
                            </div>
                            <button type="submit" class="w-full btn-primary text-white font-semibold py-3 px-8 rounded-lg">
                                Pay ৳${price}
                            </button>
                        </form>
                    </div>
                </div>
            `;
            document.body.appendChild(paymentModal);
            feather.replace();

            // Handle payment form submission
            const paymentForm = paymentModal.querySelector('#paymentForm');
            paymentForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                // Here you would typically integrate with a payment gateway
                alert('Payment processing is simulated. In a real application, this would connect to a payment gateway.');
                paymentModal.remove();
            });
        };

        // Update product cards with wishlist and buy now buttons
        document.querySelectorAll('.product-card').forEach(card => {
            const productId = card.dataset.id;
            const productName = card.dataset.title;
            const price = card.dataset.price;
            const image = card.dataset.image;

            // Add wishlist button
            const wishlistBtn = document.createElement('button');
            wishlistBtn.className = 'absolute top-4 right-4 bg-white/10 hover:bg-white/20 p-2 rounded-full transition';
            wishlistBtn.innerHTML = '<i data-feather="heart" class="w-5 h-5 text-white"></i>';
            wishlistBtn.onclick = (e) => {
                e.stopPropagation();
                addToWishlist(productId, productName, price, image);
            };
            card.appendChild(wishlistBtn);

            // Add buy now button
            const buyNowBtn = document.createElement('button');
            buyNowBtn.className = 'absolute bottom-4 right-4 bg-sky-600 hover:bg-sky-500 text-white px-4 py-2 rounded-lg transition';
            buyNowBtn.textContent = 'Buy Now';
            buyNowBtn.onclick = (e) => {
                e.stopPropagation();
                buyNow(productId, productName, price, image);
            };
            card.appendChild(buyNowBtn);
        });

        // Add wishlist section to user panel
        if (userPanel) {
            const wishlistSection = document.createElement('div');
            wishlistSection.className = 'mt-8';
            wishlistSection.innerHTML = `
                <h3 class="text-xl font-bold text-white mb-4">My Wishlist</h3>
                <div id="wishlistItems" class="space-y-4"></div>
            `;
            userPanel.appendChild(wishlistSection);
        }

        // Load wishlist items
        const loadWishlist = async (user) => {
            if (!user) return;

            try {
                const wishlistRef = ref(database, `wishlists/${user.uid}`);
                const wishlistSnapshot = await get(wishlistRef);
                const wishlistItems = wishlistSnapshot.val();

                const wishlistContainer = document.getElementById('wishlistItems');
                if (!wishlistContainer) return;

                if (wishlistItems) {
                    wishlistContainer.innerHTML = Object.values(wishlistItems).map(item => `
                        <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                            <div class="flex items-center space-x-4">
                                <img src="${item.image}" alt="${item.productName}" class="w-16 h-16 object-cover rounded-lg">
                                <div>
                                    <h4 class="text-white font-semibold">${item.productName}</h4>
                                    <p class="text-sky-400">৳${item.price}</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="buyNow('${item.productId}', '${item.productName}', '${item.price}', '${item.image}')" 
                                        class="bg-sky-600 hover:bg-sky-500 text-white px-4 py-2 rounded-lg transition">
                                    Buy Now
                                </button>
                                <button onclick="removeFromWishlist('${item.productId}')" 
                                        class="bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg transition">
                                    Remove
                                </button>
                            </div>
                        </div>
                    `).join('');
                } else {
                    wishlistContainer.innerHTML = '<p class="text-gray-400">Your wishlist is empty</p>';
                }
            } catch (error) {
                console.error('Error loading wishlist:', error);
            }
        };

        // Remove from wishlist
        const removeFromWishlist = async (productId) => {
            const user = auth.currentUser;
            if (!user) return;

            try {
                const wishlistRef = ref(database, `wishlists/${user.uid}/${productId}`);
                await set(wishlistRef, null);
                await loadWishlist(user);

                // Show success message
                const successMessage = document.createElement('div');
                successMessage.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                successMessage.textContent = 'Removed from wishlist!';
                document.body.appendChild(successMessage);
                setTimeout(() => successMessage.remove(), 3000);
            } catch (error) {
                console.error('Error removing from wishlist:', error);
                alert('Failed to remove from wishlist. Please try again.');
            }
        };

        // Update auth state change listener to load wishlist
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                await loadWishlist(user);
            }
        });

        // Make functions available globally
        window.addToWishlist = addToWishlist;
        window.buyNow = buyNow;
        window.removeFromWishlist = removeFromWishlist;
    </script>

</body>
</html>
